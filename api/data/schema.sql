DROP TABLE IF EXISTS users CASCADE;
DROP TABLE IF EXISTS permission CASCADE;

CREATE TABLE users (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
full_name VARCHAR(255) NOT NULL,
email VARCHAR(100) NOT NULL,
added_in DATE ,
modified_in DATE ,
profile_image VARCHAR(512),
phone VARCHAR(20),
password VARCHAR(100) NOT NULL,
active BOOLEAN NOT NULL
);
ALTER TABLE users ADD CONSTRAINT pk_user PRIMARY KEY (id);
ALTER TABLE users ADD CONSTRAINT uk_user_email UNIQUE (email);

CREATE TABLE permission (
id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
function VARCHAR(100) NOT NULL,
user_id BIGINT NOT NULL
);
ALTER TABLE permission ADD CONSTRAINT pk_permission PRIMARY KEY (id);
ALTER TABLE permission ADD CONSTRAINT uk_permission UNIQUE (function, user_id);
ALTER TABLE permission ADD CONSTRAINT fk_permission_user FOREIGN KEY (user_id) REFERENCES users;